{"ast":null,"code":"import _regeneratorRuntime from \"/home/runner/NeoFox/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _asyncToGenerator from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/home/runner/NeoFox/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/runner/NeoFox/pages/Components/Messages.tsx\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport styles from './../Style/Components/Messages.module.css';\nimport { firestore, firebase } from './../Scripts/Firebase';\nimport Message from './Message';\n\nvar Messages = /*#__PURE__*/function (_React$Component) {\n  _inherits(Messages, _React$Component);\n\n  var _super = _createSuper(Messages);\n\n  function Messages(props) {\n    var _this;\n\n    _classCallCheck(this, Messages);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      Messages: new Map(),\n      Limit: 7\n    });\n\n    firestore.collection(\"Servers/\".concat(_this.props.SID, \"/Messages\")).limit(_this.state.Limit).orderBy('Created', 'desc').onSnapshot( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(Server) {\n        var Msgs;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                Msgs = _this.state.Messages;\n                Server.docChanges().forEach(function (Msg) {\n                  if (Msg.type != 'removed') {\n                    var Data = Msg.doc.data();\n                    if (!Data.Created) return;\n                    var Time = Data.Created.toMillis();\n                    Msgs.set(Msg.doc.id, {\n                      Time: Time,\n                      Msg: /*#__PURE__*/_jsxDEV(Message, {\n                        Self: _this.props.User,\n                        Owner: Data.UID,\n                        Username: Data.Owner,\n                        Picture: Data.Picture,\n                        Content: Data.Content,\n                        Time: Time\n                      }, Msg.doc.id, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 27,\n                        columnNumber: 17\n                      }, _assertThisInitialized(_this))\n                    });\n                  } else Msgs[\"delete\"](Msg.doc.id);\n                });\n\n                _this.setState({\n                  Messages: new Map(_toConsumableArray(Msgs.entries()).sort(function (a, b) {\n                    return b[1].Time - a[1].Time;\n                  }))\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), function () {});\n    return _this;\n  }\n\n  _createClass(Messages, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return /*#__PURE__*/_jsxDEV(\"section\", {\n        className: styles.Container,\n        onLoad: function onLoad() {\n          var remoteConfig = firebase.remoteConfig();\n          remoteConfig.settings.minimumFetchIntervalMillis = 3600000;\n          remoteConfig.defaultConfig = {\n            Message_Limit: 10\n          };\n          remoteConfig.fetchAndActivate().then(function () {\n            var val = remoteConfig.getValue('Message_Limit');\n            console.log(val);\n\n            _this2.setState({\n              Limit: parseInt(val['_value'])\n            });\n\n            console.log(_this2.state.Limit);\n          })[\"catch\"](function (err) {// ...\n          });\n        },\n        children: _toConsumableArray(this.state.Messages).map(function (e) {\n          return e[1].Msg;\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return Messages;\n}(React.Component);\n\nexport default Messages;","map":{"version":3,"sources":["/home/runner/NeoFox/pages/Components/Messages.tsx"],"names":["React","styles","firestore","firebase","Message","Messages","props","Map","Limit","collection","SID","limit","state","orderBy","onSnapshot","Server","Msgs","docChanges","forEach","Msg","type","Data","doc","data","Created","Time","toMillis","set","id","User","UID","Owner","Picture","Content","setState","entries","sort","a","b","Container","remoteConfig","settings","minimumFetchIntervalMillis","defaultConfig","Message_Limit","fetchAndActivate","then","val","getValue","console","log","parseInt","err","map","e","Component"],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport styles from './../Style/Components/Messages.module.css';\n\nimport { firestore, firebase } from './../Scripts/Firebase';\n\nimport Message from './Message';\n\ntype MyProps = { SID: string, User: any };\ntype Message_Entry = { Time: number, Msg: Message };\ntype MyState = { Messages: Map<string, Message_Entry>, Limit: number };\nclass Messages extends React.Component<MyProps, MyState> {\n  public state: MyState = { Messages: new Map(), Limit: 7 };\n  constructor(props) {\n    super(props);\n    firestore.collection(`Servers/${this.props.SID}/Messages`).limit(this.state.Limit).orderBy('Created', 'desc')\n      .onSnapshot(async Server => {\n        let Msgs: Map<string, Message_Entry> = this.state.Messages;\n        Server.docChanges().forEach(Msg => {\n          if (Msg.type != 'removed') {\n            const Data = Msg.doc.data();\n            if (!Data.Created) return;\n            let Time = Data.Created.toMillis();\n            Msgs.set(Msg.doc.id, {\n              Time,\n              Msg: (\n                <Message \n                  key={Msg.doc.id}\n                  Self={this.props.User}\n                  Owner={Data.UID}\n                  Username={Data.Owner}\n                  Picture={Data.Picture}\n                  Content={Data.Content}\n                  Time={Time}\n                />\n              )\n            });\n          } else Msgs.delete(Msg.doc.id);\n        });\n        this.setState({\n          Messages: new Map([...Msgs.entries()].sort((a, b) => b[1].Time-a[1].Time))\n        });\n      }, () => {}\n    )\n  }\n  render() {\n    return (\n      <section \n        className={styles.Container}\n        onLoad={(() => {\n          const remoteConfig = firebase.remoteConfig();\n          remoteConfig.settings.minimumFetchIntervalMillis = 3600000;\n          remoteConfig.defaultConfig = { Message_Limit: 10 };\n          remoteConfig.fetchAndActivate()\n  .then(() => {\n    const val = remoteConfig.getValue('Message_Limit');\n          console.log(val);\n          this.setState({ Limit: parseInt(val['_value']) });\n          console.log(this.state.Limit);\n  })\n  .catch((err) => {\n    // ...\n  });\n          \n        })}\n        >\n        {[...this.state.Messages].map(e => e[1].Msg)}\n      </section>\n    );\n  }\n}\nexport default Messages;"]},"metadata":{},"sourceType":"module"}